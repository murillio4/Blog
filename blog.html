<!DOCTYPE html>
<html ng-app="myApp">
    <head lang="en">
        <meta charset="UTF-8">
        <title>Get posts</title>
        <!--Inkluderer bootstrap css slik at vi kan bruke den-->
        <link rel="stylesheet" href="css/bootstrap.min.css">
    </head>
    <!--Setter at ng-controlleren skal gjelde for dette dokumentet
        Kjører funksjonen getAllPost() når siden lastes inn-->
    <body data-ng-controller="PostController" data-ng-init="getAllPosts()">
        
        <!--Lager en enkel navigasjonsbar-->
        <nav class="navbar navbar-default navbar-static-top" role="navigation">
            <div class="container container-fluid">
                <ul class="nav navbar-nav">
                    <li class="navbar-brand">
                        <img src="pictures/un-logo.png" style="height: 100%;">
                    </li>
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li class="active">
                        <a href="blog.html">Read Text</a>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="container">
            
            <article>
                <h1>Dette er min tekst</h1>
                <section>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas mollis diam suscipit ante aliquam, at volutpat enim commodo. Suspendisse pellentesque velit id mi finibus feugiat. Ut et tellus gravida, dictum quam non, elementum est. Mauris semper ut nisi eget tristique. Duis bibendum tempor nisl at rhoncus. Donec et molestie odio, eu convallis elit. Praesent sed leo leo. Aenean ultrices quam sit amet ligula luctus, ut feugiat neque finibus. Aliquam sit amet massa interdum, iaculis arcu vel, ultrices felis. Nulla iaculis ornare neque, vitae euismod ipsum lobortis in. Sed aliquet scelerisque iaculis. Fusce id hendrerit sem, et pulvinar neque. Vivamus rutrum lacinia urna sed vestibulum. Mauris congue ultrices luctus. Ut at quam ac odio lobortis tempus quis pellentesque ligula. Aliquam finibus lectus non nisi sodales cursus.</p>
                </section>
                <section>
                    <p>Duis laoreet eleifend ullamcorper. Proin luctus sollicitudin consequat. Proin sit amet elit tincidunt, sollicitudin velit et, pellentesque nibh. In eu convallis leo. In lobortis tortor quis vehicula viverra. Proin consectetur nulla sit amet libero sollicitudin, quis eleifend nunc suscipit. Donec gravida cursus velit, in auctor enim elementum a. Maecenas fermentum leo dapibus, mattis neque sed, convallis mauris. Praesent blandit porttitor finibus. Quisque vel tellus vitae ex fringilla condimentum quis vitae urna. Sed dignissim quam quis felis convallis, aliquet scelerisque libero ultrices. Integer pharetra felis sed ex eleifend lobortis. Mauris egestas congue sem sit amet pulvinar. Sed non lectus et purus imperdiet feugiat sit amet ac nibh. Sed maximus, purus in pulvinar semper, elit nisi consequat neque, et dignissim erat erat sit amet lacus.</p>
                </section>
                <section>
                    <p>Duis laoreet eleifend ullamcorper. Proin luctus sollicitudin consequat. Proin sit amet elit tincidunt, sollicitudin velit et, pellentesque nibh. In eu convallis leo. In lobortis tortor quis vehicula viverra. Proin consectetur nulla sit amet libero sollicitudin, quis eleifend nunc suscipit. Donec gravida cursus velit, in auctor enim elementum a. Maecenas fermentum leo dapibus, mattis neque sed, convallis mauris. Praesent blandit porttitor finibus. Quisque vel tellus vitae ex fringilla condimentum quis vitae urna. Sed dignissim quam quis felis convallis, aliquet scelerisque libero ultrices. Integer pharetra felis sed ex eleifend lobortis. Mauris egestas congue sem sit amet pulvinar. Sed non lectus et purus imperdiet feugiat sit amet ac nibh. Sed maximus, purus in pulvinar semper, elit nisi consequat neque, et dignissim erat erat sit amet lacus.</p>
                </section>
                <section>
                    <p>Interdum et malesuada fames ac ante ipsum primis in faucibus. Nam imperdiet odio in enim eleifend, ut mollis massa rutrum. Ut varius mattis erat laoreet viverra. Aenean ut mauris in augue semper pellentesque. Maecenas mattis metus velit, iaculis posuere elit tincidunt faucibus. Etiam ut est aliquam, eleifend velit eget, condimentum dolor. Proin ut orci aliquet, ornare leo at, tincidunt enim. Sed ultricies mollis diam, nec maximus libero tempor eu. Morbi eu urna quis mauris aliquam tempus. Proin fermentum justo quam, nec pulvinar dui pretium vitae. Phasellus sit amet pellentesque metus.</p>
                </section>
                <section>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas mollis diam suscipit ante aliquam, at volutpat enim commodo. Suspendisse pellentesque velit id mi finibus feugiat. Ut et tellus gravida, dictum quam non, elementum est. Mauris semper ut nisi eget tristique. Duis bibendum tempor nisl at rhoncus. Donec et molestie odio, eu convallis elit. Praesent sed leo leo. Aenean ultrices quam sit amet ligula luctus, ut feugiat neque finibus. Aliquam sit amet massa interdum, iaculis arcu vel, ultrices felis. Nulla iaculis ornare neque, vitae euismod ipsum lobortis in. Sed aliquet scelerisque iaculis. Fusce id hendrerit sem, et pulvinar neque. Vivamus rutrum lacinia urna sed vestibulum. Mauris congue ultrices luctus. Ut at quam ac odio lobortis tempus quis pellentesque ligula. Aliquam finibus lectus non nisi sodales cursus.</p>
                </section>
            </article>
            <hr>
            <br>
            <h3>Commments:</h3>
            <!--Melding som vises hvis variabelen found = false-->
            <div class="alert alert-danger" role="alert" ng-show="!found">There is no posts to show</div>
            <!--div'en vises om det er noe data i variabelen posts (sjekker samme som: $scope.found = $scope.posts.length > 0;)-->
            <div ng-show="posts.length > 0">
                <article>
                    <!--dataen sendes i en array, og for hvert element i denne arrayen lag en ny section. Dette kalles en foreach løkke-->
                    <section ng-repeat="post in posts">
                        <!--Henter ut title og content fra variabelen post deklarert over-->
                        <header class="section-header"><h4>{{post.title}}</h4></header>
                        <p>{{post.content}}</p>
                        <footer>{{post.time}}</footer>
                    </section>
                </article>
            </div>
            <br>
            <h3>Create a comment:</h3>
            <!--Lager en form for å hente data fra brukeren
                Deklarerer også hvilken funksjon som kjøres når du trykker på Submit knappen (herav addPost())-->
            <form ng-submit="addPost()" role="form">
                <div class="form-group">
                    <label for="inpTitle">Name:</label>
                    <!--Lager en input for title, og setter ng-model = inpTitle slik at vi kan bruke dataen i angular-->
                    <input ng-model="inpTitle" type="text" class="form-control" id="inpTitle" placeholder="Enter You're Name" required>
                </div>
                <div class="form-group">
                    <label for="inpContent">Comment:</label>
                    <!--Lager et textarea input for content, og setter ng-model = inpContent slik at vi kan bruke dataen i angular-->
                    <textarea ng-model="inpContent" class="form-control" id="inpContent" placeholder="Enter Comment" required></textarea>
                </div>
                <button type="submit" class="btn btn-default">GO!</button>
            </form>
        </div>

        <!--Henter inn API'en angular.js-->
        <script src="js/angular.min.js"></script>
        <script>
            //Deklarerer angular modulen
            var myApp = angular.module("myApp", []);
            //Lager klassen til kontrolleren for siden
            myApp.controller("PostController", function($scope, $http){
                //setter variabelen found lik true slik at meldingen over ikke vises
                $scope.found = true;
                //Deklarerer metoden getAllPosts
                $scope.getAllPosts = function() {
                    //Gjør en get request til php dokumentet getPosts uten å sende med noen parametere
                    //Om den går igjennom kjør succsess
                    $http.get("php/getPosts.php").success(function(data){
                        //setter variabelen posts lik det php dokummentet returnerer
                        $scope.posts = data;
                        //Sjekker om det er noe data i det som er returnert fra php dokumentet
                        //Om ikke sett variabelen posts lik false, som da gjør at meldingen over vises
                        $scope.found = $scope.posts.length > 0;
                    });
                };
                
                $scope.addPost = function() {
                    //Gjør en get request til php dokumentet createPost og sender med to parametere, title og content
                    //Om den går igjennom kjør succsess
                    $http.get("php/createPost.php", {
                      params : {
                          'title' : $scope.inpTitle,
                          'content' : $scope.inpContent
                      }
                    //her returneres det ingen data fra php dokumentet vi har kjørt
                    }).success(function() {
                        //Setter innholdet i de to inputtene over lik ingenting
                        $scope.inpTitle = "";
                        $scope.inpContent = "";
                        //setter pekeren tilbake på title inputtet
                        document.querySelector("#inpTitle").focus();
                    });
                };
            });
        </script>

    </body>
</html>